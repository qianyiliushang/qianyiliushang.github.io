---
title: 常见抓包工具使用
date: 2017-12-01 11:53:11
tags: 测试,other
categories: other
---

windows & mac下常用抓包工具使用
<!-- more -->

## PC&Mac web应用抓包

桌面端抓包相对来说比较简单，用chrome或者firefox自带的调试工具即可

* 打开调试工具(以下两种方式都可以)
  * 右键检查
  * 浏览器选项 - 更多工具 - 开发者工具
* 点击`Network`

![chrome console](http://o86koa12m.bkt.clouddn.com/WX20171204-153714@2x.png)

All是所有该页面的网络请求

XHR是http请求

WS是webservise请求

其它分类是不同类型的资源文件

### 示例&分析 - http接口

![请求示例截图](http://o86koa12m.bkt.clouddn.com/WX20171204-155656@2x.png)

选择要查看的接口请求，右方会出现请求详情

主要关注点：

* Request URL，看看调用的接口地址是否正确
* Form Data，以form表单形式提交的数据都在这里
* Response/Preview，点击后查看接口返回详情。Preview会根据response header中的content-type对返回的数据进行格式化处理

![接口返回示例](http://o86koa12m.bkt.clouddn.com/WX20171204-155722@2x.png)

### 示例&分析 - webservice

对于webservice，只需要关注长链接里的数据帧即可，方法如下：

* 打开控制台调试
* 登录web-im
* 依次点击控制台中的`Network``WS`
* 选择左边已建立的链接再点击Frames

![ws示例](http://o86koa12m.bkt.clouddn.com/WX20171204-161024@2x.png)

上面标出的42263是webservice请求数据，对应的请求数据也是42263(用向下的箭头标识)，点击即可查看服务端响应



## 移动端抓包

### 使用系统代理

#### Wireshark

**Wireshark**是一个使用比较广泛的网络协议分析工具，[官方网站](https://www.wireshark.org/)

##### 主要特性

* 支持上百种协议
* 实时捕获和离线分析
* 多平台支持：macOS, Windows,Linux etc.
* 强大的过滤器
* 多种协议解密支持：IPsec, ISAKMP, SSL/TLS etc.

##### 使用方法

* 在安装了wireshark的机器上开启wifi网络共享
* 移动设备连接共享的wifi热点


* 启动wireshark并选择共享出wifi热点的网卡

如下图所示，wireshark第一次打开时会列出电脑上的所有网卡，选择要抓包的网卡，如果选错了，可能什么数据都抓不到。作为示例，本次使用en7这个网卡

![选择网卡](http://o86koa12m.bkt.clouddn.com/WX20171204-140904@2x.png)

打开手机app，此时移动设备上的所有流量都会经过wireshark

为方便查看，需要加一些过滤规则`ip.addr == 192.168.1.239 && http`,这里只查看所有到239服务器的http请求。在手机上更新一个个人资料，然后看一下抓包数据

![](http://o86koa12m.bkt.clouddn.com/WX20171204-175842@2x.png)

圈出来的这两行分别是请求和响应数据

由于wireshark是直接抓取网卡上的网络请求，因此，任何连接共享网络的设备的网络请求都可以抓取而不需要再另外设置代理。

其它类似的软件还有Fiddler(windows), Charles(Mac), fiddler抓包后还可以对抓包内容进行修改并重新发送请求。

#### Charles

> Charles是一款Mac上的HTTP代理服务器、HTTP监视器、反向代理服务器，可以让开发者监视查看所有连接互联网的HTTP通信，包括请求，响应和HTTP头信息等等

使用方法

* 在安装了charles的电脑上共享wifi
* 打开charles
* 设置代理及端口![](http://o86koa12m.bkt.clouddn.com/WX20171204-201418@2x.png)
* 移动端连接刚才共享的热点
* 移动端设置代理![](http://o86koa12m.bkt.clouddn.com/65b101d127ef62733c5ef3245d2744e9.jpg)
* 开始抓包![](http://o86koa12m.bkt.clouddn.com/WX20171204-201008@2x.png)